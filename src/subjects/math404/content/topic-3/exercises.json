[
  {
    "id": "math404-t3-ex01",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Dual LP Formulation",
    "description": "Construct the dual of a given linear program using the standard rules.",
    "difficulty": 2,
    "hints": [
      "Each primal constraint → one dual variable",
      "Each primal variable → one dual constraint",
      "Transpose coefficient matrix and swap c, b vectors"
    ],
    "solution": "**Primal (max):**\nmax 4x₁ + 3x₂\ns.t. 2x₁ + x₂ ≤ 10\n     x₁ + 3x₂ ≤ 12\n     x₁ + x₂ = 5\n     x₁ ≥ 0, x₂ free\n\n**Dual Construction:**\n\n| Primal (max) | Dual (min) |\n|--------------|------------|\n| ≤ constraint | y ≥ 0      |\n| = constraint | y free     |\n| x ≥ 0        | ≥ constraint|\n| x free       | = constraint|\n\n**Dual (min):**\nmin 10y₁ + 12y₂ + 5y₃\ns.t. 2y₁ + y₂ + y₃ ≥ 4   (from x₁ ≥ 0)\n     y₁ + 3y₂ + y₃ = 3   (from x₂ free)\n     y₁, y₂ ≥ 0, y₃ free\n\n**Verification:**\n- Primal has 2 variables, dual has 2+1=3 constraints (counting = as 2)\n- Primal has 2+2=4 constraints, dual has 3 variables\n- Coefficient matrix transposes: A → Aᵀ"
  },
  {
    "id": "math404-t3-ex02",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Weak Duality Theorem",
    "description": "Prove weak duality and use it to bound an LP's optimal value.",
    "difficulty": 2,
    "hints": [
      "For feasible primal x and dual y: cᵀx ≤ bᵀy (max) or cᵀx ≥ bᵀy (min)",
      "Use constraint multiplications",
      "Provides stopping criterion: if cᵀx = bᵀy, both optimal"
    ],
    "solution": "**Weak Duality Proof:**\n\n**Primal (P):** max cᵀx s.t. Ax ≤ b, x ≥ 0\n**Dual (D):** min bᵀy s.t. Aᵀy ≥ c, y ≥ 0\n\nFor feasible x (primal) and y (dual):\ncᵀx ≤ (Aᵀy)ᵀx = yᵀ(Ax) ≤ yᵀb = bᵀy\n\nTherefore: **cᵀx ≤ bᵀy** (primal ≤ dual)\n\n**Application:**\n\nPrimal: max 2x₁ + 3x₂, s.t. x₁ + 2x₂ ≤ 8, 3x₁ + 2x₂ ≤ 12, x ≥ 0\nDual: min 8y₁ + 12y₂, s.t. y₁ + 3y₂ ≥ 2, 2y₁ + 2y₂ ≥ 3, y ≥ 0\n\n**Feasible solutions:**\n- Primal: x = (2, 3) → z_P = 2·2 + 3·3 = 13 (lower bound on optimal)\n- Dual: y = (1, 1) → z_D = 8·1 + 12·1 = 20 (upper bound on optimal)\n\n**Conclusion:** 13 ≤ z* ≤ 20\n\n**Better dual:** y = (1/2, 1/2)\nCheck: 1/2 + 3/2 = 2 ≥ 2 ✓, 1 + 1 = 2 < 3 ✗ (infeasible)\n\nTry y = (0, 1): 0 + 3 = 3 ≥ 2 ✓, 0 + 2 = 2 < 3 ✗\nTry y = (1, 1/3): 1 + 1 = 2 ≥ 2 ✓, 2 + 2/3 = 8/3 ≥ 3 ✗\n\n**If we find cᵀx* = bᵀy*:** Both optimal by weak duality!"
  },
  {
    "id": "math404-t3-ex03",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Strong Duality Verification",
    "description": "Verify strong duality by showing the optimal values of primal and dual are equal.",
    "difficulty": 3,
    "hints": [
      "Solve both primal and dual",
      "Check that p* = d* (zero duality gap)",
      "Strong duality holds for LPs when feasible"
    ],
    "solution": "**Primal:**\nmax 3x₁ + 2x₂\ns.t. x₁ + x₂ ≤ 4\n     2x₁ + x₂ ≤ 6\n     x ≥ 0\n\n**Solve by simplex:**\nOptimal: x* = (2, 2), z*_P = 3·2 + 2·2 = 10\n\n**Dual:**\nmin 4y₁ + 6y₂\ns.t. y₁ + 2y₂ ≥ 3\n     y₁ + y₂ ≥ 2\n     y ≥ 0\n\n**Solve dual:**\nGraphically or by simplex:\nActive constraints: y₁ + 2y₂ = 3, y₁ + y₂ = 2\nSolving: y₂ = 1, y₁ = 1\nOptimal: y* = (1, 1), z*_D = 4·1 + 6·1 = 10\n\n**Strong Duality:** z*_P = z*_D = 10 ✓\n\n**Complementary Slackness Verification:**\nPrimal:\n- x₁* = 2 > 0 → dual constraint 1 active: y₁ + 2y₂ = 3 ✓\n- x₂* = 2 > 0 → dual constraint 2 active: y₁ + y₂ = 2 ✓\n\nDual:\n- y₁* = 1 > 0 → primal constraint 1 active: x₁ + x₂ = 4 ✓\n- y₂* = 1 > 0 → primal constraint 2 active: 2x₁ + x₂ = 6 ✓\n\nAll complementary slackness conditions hold!"
  },
  {
    "id": "math404-t3-ex04",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Complementary Slackness Conditions",
    "description": "Use complementary slackness to find the optimal dual solution from a known primal solution.",
    "difficulty": 3,
    "hints": [
      "If xⱼ > 0, then j-th dual constraint is tight",
      "If i-th primal constraint is slack, then yᵢ = 0",
      "Solve system of equations from active constraints"
    ],
    "solution": "**Problem:**\nmax 5x₁ + 4x₂ + 3x₃\ns.t. 2x₁ + 3x₂ + x₃ ≤ 5   (constraint 1)\n     4x₁ + x₂ + 2x₃ ≤ 11  (constraint 2)\n     3x₁ + 4x₂ + 2x₃ ≤ 8   (constraint 3)\n     x ≥ 0\n\n**Given:** Primal optimal x* = (2, 0, 1), z* = 13\n\n**Verify feasibility:**\n2·2 + 0 + 1 = 5 ≤ 5 (active)\n4·2 + 0 + 2·1 = 10 ≤ 11 (slack = 1)\n3·2 + 0 + 2·1 = 8 ≤ 8 (active)\n\n**Dual:**\nmin 5y₁ + 11y₂ + 8y₃\ns.t. 2y₁ + 4y₂ + 3y₃ ≥ 5   (from x₁)\n     3y₁ + y₂ + 4y₃ ≥ 4   (from x₂)\n     y₁ + 2y₂ + 2y₃ ≥ 3   (from x₃)\n     y ≥ 0\n\n**Complementary Slackness:**\n- x₁* = 2 > 0 → 2y₁ + 4y₂ + 3y₃ = 5\n- x₂* = 0 → no requirement\n- x₃* = 1 > 0 → y₁ + 2y₂ + 2y₃ = 3\n- Constraint 2 slack → y₂* = 0\n- Constraints 1,3 active → y₁*, y₃* ≥ 0\n\n**Solve:**\nWith y₂ = 0:\n2y₁ + 3y₃ = 5\ny₁ + 2y₃ = 3\n\nFrom second: y₁ = 3 - 2y₃\nInto first: 2(3-2y₃) + 3y₃ = 5\n6 - 4y₃ + 3y₃ = 5\ny₃ = 1, y₁ = 1\n\n**Dual optimal:** y* = (1, 0, 1), z*_D = 5·1 + 0 + 8·1 = 13 ✓"
  },
  {
    "id": "math404-t3-ex05",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Economic Interpretation of Dual Variables",
    "description": "Interpret dual variables as shadow prices in a resource allocation problem.",
    "difficulty": 2,
    "hints": [
      "Dual variable = marginal value of resource",
      "If yᵢ = 5, increasing bᵢ by 1 increases profit by 5",
      "Zero dual → resource is not scarce (slack in primal)"
    ],
    "solution": "**Production Problem:**\nMaximize profit from products A, B:\nmax 40x_A + 30x_B\ns.t. 2x_A + x_B ≤ 100  (hours of machine time)\n     x_A + 2x_B ≤ 80   (kg of raw material)\n     x_A, x_B ≥ 0\n\n**Optimal Solution:**\nx* = (40, 20), profit = 40·40 + 30·20 = $2200\n\nBoth constraints active:\n2·40 + 20 = 100 (full machine time)\n40 + 2·20 = 80 (full material)\n\n**Dual Variables (Shadow Prices):**\ny₁* = 10 (machine time)\ny₂* = 10 (material)\n\n**Economic Interpretation:**\n\n**1. Machine Time (y₁ = 10):**\n- Worth $10 per hour\n- Increasing machine time from 100→101 hours increases profit by ~$10\n- Decreasing to 99 hours decreases profit by ~$10\n\n**2. Material (y₂ = 10):**\n- Worth $10 per kg\n- Should acquire more material if cost < $10/kg\n- Should sell material if can get > $10/kg\n\n**Example:** Suppose we can:\n- Rent extra machine: $8/hour → DO IT! (net gain $2/hour)\n- Buy material: $12/kg → DON'T! (net loss $2/kg)\n\n**Dual Optimal Value:**\n100·10 + 80·10 = 2200 = primal optimal (strong duality)\n\n**If constraint has slack:** y = 0\nExample: Add constraint x_A ≤ 50 (not binding)\nThen y₃ = 0 (no value to increasing this limit)"
  },
  {
    "id": "math404-t3-ex06",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Dual of Dual is Primal",
    "description": "Prove that taking the dual of the dual LP returns the original primal problem.",
    "difficulty": 3,
    "hints": [
      "Start with primal in standard form",
      "Construct dual systematically",
      "Take dual of the dual using same rules"
    ],
    "solution": "**Primal (P):**\nmax cᵀx\ns.t. Ax ≤ b\n     x ≥ 0\n\n**Dual (D):**\nmin bᵀy\ns.t. Aᵀy ≥ c\n     y ≥ 0\n\n**Dual of Dual (DD):**\nRewrite (D) in max form:\nmax -bᵀy\ns.t. -Aᵀy ≤ -c\n     y ≥ 0\n\n**Take dual of this:**\nmin -cᵀz\ns.t. (-Aᵀ)ᵀz ≥ -b\n     z ≥ 0\n\nSimplify:\nmin -cᵀz\ns.t. -Az ≥ -b  (equivalently: Az ≤ b)\n     z ≥ 0\n\nMultiply objective by -1 (max → min):\n**max cᵀz s.t. Az ≤ b, z ≥ 0**\n\nThis is identical to (P) with z replacing x! ∎\n\n**Example:**\n\nP: max 3x₁ + 2x₂, s.t. x₁ + x₂ ≤ 4, x ≥ 0\nD: min 4y, s.t. y ≥ 3, y ≥ 2, y ≥ 0\n   Simplifying: min 4y, s.t. y ≥ 3\nDD: Taking dual again returns to P\n\n**Intuition:** Duality is a symmetric relationship."
  },
  {
    "id": "math404-t3-ex07",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Farkas' Lemma Application",
    "description": "Use Farkas' Lemma to prove a system of linear inequalities is infeasible.",
    "difficulty": 4,
    "hints": [
      "Farkas: Exactly one holds: (1) Ax ≤ b, x ≥ 0 OR (2) Aᵀy ≥ 0, bᵀy < 0, y ≥ 0",
      "To prove (1) infeasible, find y satisfying (2)",
      "This is the certificate of infeasibility"
    ],
    "solution": "**Farkas' Lemma:**\nExactly one of the following holds:\n1. ∃x: Ax ≤ b, x ≥ 0\n2. ∃y: Aᵀy ≥ 0, bᵀy < 0, y ≥ 0\n\n**Problem:** Prove infeasible:\nx₁ + 2x₂ ≤ 3\n2x₁ + x₂ ≤ 3\n-x₁ - x₂ ≤ -4\nx ≥ 0\n\n**In matrix form:**\nA = [[1, 2], [2, 1], [-1, -1]], b = [3, 3, -4]ᵀ\n\n**Find certificate y:**\nNeed: Aᵀy ≥ 0, bᵀy < 0, y ≥ 0\n\nAᵀy = [[1,2,-1], [2,1,-1]][[y₁],[y₂],[y₃]]\n     = [[y₁+2y₂-y₃], [2y₁+y₂-y₃]]\n\nTry y₁ = y₂ = y₃ = 1:\nAᵀy = [1+2-1, 2+1-1] = [2, 2] ≥ 0 ✓\nbᵀy = 3·1 + 3·1 + (-4)·1 = 2 ≮ 0 ✗\n\nTry y₁ = y₂ = 0, y₃ = 1:\nAᵀy = [-1, -1] ≮ 0 ✗\n\nTry y₁ = y₂ = 1, y₃ = 2:\nAᵀy = [1+2-2, 2+1-2] = [1, 1] ≥ 0 ✓\nbᵀy = 3 + 3 - 8 = -2 < 0 ✓\n\n**Certificate found:** y* = (1, 1, 2)\nThis proves system is **infeasible**.\n\n**Geometric interpretation:**\ny gives a linear combination of constraints:\n1·(x₁+2x₂) + 1·(2x₁+x₂) + 2·(-x₁-x₂) ≤ 1·3 + 1·3 + 2·(-4)\nx₁ + 2x₂ + 2x₁ + x₂ - 2x₁ - 2x₂ ≤ -2\nx₁ + x₂ ≤ -2\n\nBut x ≥ 0 implies x₁ + x₂ ≥ 0, contradiction!"
  },
  {
    "id": "math404-t3-ex08",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Dual Simplex Method",
    "description": "Apply the dual simplex method to solve an LP starting from dual feasible but primal infeasible basis.",
    "difficulty": 4,
    "hints": [
      "Dual simplex maintains dual feasibility",
      "Selects leaving variable with most negative RHS",
      "Ratio test ensures dual feasibility maintained"
    ],
    "solution": "**Problem:**\nmin 2x₁ + 3x₂\ns.t. x₁ + x₂ ≥ 3\n     2x₁ + x₂ ≥ 4\n     x ≥ 0\n\n**Standard form (slack/surplus):**\nmin 2x₁ + 3x₂\ns.t. x₁ + x₂ - s₁ = 3\n     2x₁ + x₂ - s₂ = 4\n     x, s ≥ 0\n\n**Initial tableau (basis s₁, s₂):**\n| BV | x₁ | x₂ | s₁ | s₂ | RHS |\n|----|----|----|----|----|-----|\n| s₁ | 1  | 1  | -1 | 0  | 3   |\n| s₂ | 2  | 1  | 0  | -1 | 4   |\n| z  | -2 | -3 | 0  | 0  | 0   |\n\n**Problem:** RHS values 3, 4 are positive, but s₁, s₂ coefficients are -1\nAfter converting: -s₁ = -3, -s₂ = -4 (primal infeasible)\n\n**Multiply rows by -1:**\n| BV | x₁ | x₂ | s₁ | s₂ | RHS  |\n|----|----|----|----|----|------|\n| s₁ | -1 | -1 | 1  | 0  | -3   |\n| s₂ | -2 | -1 | 0  | 1  | -4   |\n| z  | -2 | -3 | 0  | 0  | 0    |\n\n**Dual Simplex:**\n\n**Iteration 1:**\n- Leaving: most negative RHS = -4 (row 2, s₂ leaves)\n- Entering: ratio test on objective row: min{-2/-2, -3/-1} = min{1, 3} = 1\n  → x₁ enters\n\n**Pivot on a₂₁ = -2:**\nDivide row 2 by -2:\n| x₁ | x₂  | s₁ | s₂  | RHS |\n|----|-----|----|-----|-----|\n| 1  | 1/2 | 0  |-1/2 | 2   |\n\nUpdate other rows...\n\n**Final tableau:**\n| BV | x₁ | x₂ | s₁ | s₂ | RHS |\n|----|----|----|----|----|-----|\n| x₂ | 0  | 1  | 2  | -1 | 1   |\n| x₁ | 1  | 0  |-1  | 1  | 1   |\n| z  | 0  | 0  | 1  | 1  | 7   |\n\n**Optimal:** x* = (1, 1), z* = 7\n\n**Dual Simplex Use Cases:**\n1. After adding cutting planes in integer programming\n2. Re-optimization after constraint changes\n3. When dual feasible starting basis available"
  },
  {
    "id": "math404-t3-ex09",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Duality Gap Analysis",
    "description": "Analyze the duality gap for a sequence of approximations to an LP.",
    "difficulty": 3,
    "hints": [
      "Duality gap = |primal objective - dual objective|",
      "Gap = 0 at optimality (strong duality)",
      "Can use gap as stopping criterion"
    ],
    "solution": "**Problem:**\nPrimal (P): max 3x₁ + 4x₂, s.t. x₁ + 2x₂ ≤ 8, 2x₁ + x₂ ≤ 8, x ≥ 0\nDual (D): min 8y₁ + 8y₂, s.t. y₁ + 2y₂ ≥ 3, 2y₁ + y₂ ≥ 4, y ≥ 0\n\n**Iteration sequence:**\n\n| Iter | Primal x        | z_P | Dual y      | z_D | Gap |\n|------|-----------------|-----|-------------|-----|-----|\n| 0    | (0, 0)          | 0   | (3, 2)      | 40  | 40  |\n| 1    | (4, 0)          | 12  | (2, 1)      | 24  | 12  |\n| 2    | (0, 4)          | 16  | (1, 2)      | 24  | 8   |\n| 3    | (2.67, 2.67)    | 18.7| (1.33,1.33) | 21.3| 2.6 |\n| 4    | (8/3, 8/3)      | 56/3| (4/3, 4/3)  | 64/3| 8/3 |\n| *    | (8/3, 8/3)      | 56/3| (4/3, 4/3)  | 64/3| 0   |\n\nWait, let me recalculate optimum:\n\n**Solve P graphically:**\nVertices: (0,0), (4,0), (0,4), (8/3,8/3)\nEvaluate:\n- (0,0): 0\n- (4,0): 12\n- (0,4): 16\n- (8/3,8/3): 3·8/3 + 4·8/3 = 24/3 + 32/3 = 56/3 ≈ 18.67\n\nOptimal P: x* = (8/3, 8/3), z*_P = 56/3\n\n**Solve D:**\nActive: y₁ + 2y₂ = 3, 2y₁ + y₂ = 4\nSolving: y₁ = 5/3, y₂ = 2/3\nz*_D = 8·5/3 + 8·2/3 = 40/3 + 16/3 = 56/3\n\n**Duality gap at optimum = 0** ✓\n\n**Practical use:**\nStop when gap < ε:\n|z_P - z_D| < 10⁻⁶\nThis guarantees both within 10⁻⁶ of true optimum."
  },
  {
    "id": "math404-t3-ex10",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Unbounded Primal and Dual",
    "description": "Analyze the relationship between primal and dual when one is unbounded.",
    "difficulty": 3,
    "hints": [
      "If primal unbounded → dual infeasible",
      "If dual unbounded → primal infeasible",
      "Both can be infeasible simultaneously"
    ],
    "solution": "**Theorem:** For LP primal-dual pair:\n1. If P is unbounded → D is infeasible\n2. If D is unbounded → P is infeasible\n3. Both P and D can be infeasible\n4. Exactly one holds: both optimal, one unbounded (other infeasible), both infeasible\n\n**Example 1: Unbounded Primal**\nP: max x₁ + x₂, s.t. -x₁ + x₂ ≤ 1, x ≥ 0\nD: min y, s.t. -y ≥ 1, y ≥ 1, y ≥ 0\n\nFor P: Move along direction (1,1): objective unbounded\nFor D: Need y ≥ 1 and -y ≥ 1, impossible!\n**P unbounded, D infeasible** ✓\n\n**Example 2: Both Infeasible**\nP: max x, s.t. x ≤ -1, x ≥ 0\n   No x satisfies x ≥ 0 and x ≤ -1\n\nD: min -y, s.t. y ≥ 1, y ≥ 0\n   This simplifies to max y, s.t. y ≥ 1, y ≥ 0\n   Unbounded!\n\nActually by duality: D infeasible too.\nLet me reconsider...\n\nP: max x₁, s.t. x₁ ≤ 1, -x₁ ≤ -2, x₁ ≥ 0\n   Need x₁ ≤ 1 and x₁ ≥ 2 → infeasible\n\nD: min y₁ - 2y₂, s.t. y₁ - y₂ ≥ 1, y ≥ 0\n   Set y₁ = 0, y₂ → ∞: objective → -∞ → unbounded\n\n**Both P and D infeasible:**\nP: max x, s.t. x ≤ 1, x ≥ 2\nD: min y₁ + 2y₂, s.t. y₁ + y₂ ≥ 1, y₁ - y₂ = 0, y ≥ 0\n   From y₁ = y₂: 2y₁ ≥ 1 → y₁ ≥ 1/2\n   But objective= y₁ + 2y₁ = 3y₁, minimum at y₁ = 1/2, gives 3/2\n\nLet me use standard example:\nP: max x₁ - x₂, s.t. x₁ - x₂ ≤ 1, -x₁ + x₂ ≤ -2, x ≥ 0\nD: min y₁ - 2y₂, s.t. y₁ - y₂ ≥ 1, -y₁ + y₂ ≥ -1, y ≥ 0\n\nFrom constraints: y₁ - y₂ ≥ 1 and y₁ - y₂ ≤ 1 → y₁ - y₂ = 1\nObjective unbounded below.\n\n**Summary:**\n- Weak duality prevents both from being unbounded\n- Both can be infeasible\n- If one feasible and bounded, strong duality ensures both optimal"
  },
  {
    "id": "math404-t3-ex11",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Lagrangian Dual for QP",
    "description": "Derive the Lagrangian dual of a quadratic programming problem.",
    "difficulty": 4,
    "hints": [
      "Form Lagrangian L(x,λ) = f(x) + λᵀg(x)",
      "Dual function g(λ) = inf_x L(x,λ)",
      "Dual problem: max g(λ) s.t. λ ≥ 0"
    ],
    "solution": "**Primal QP:**\nmin (1/2)xᵀQx + cᵀx\ns.t. Ax ≥ b\n     x ≥ 0\n\nwhere Q ⪰ 0 (positive semidefinite)\n\n**Lagrangian:**\nL(x,λ,μ) = (1/2)xᵀQx + cᵀx - λᵀ(Ax - b) - μᵀx\n\n**Dual Function:**\ng(λ,μ) = inf_x L(x,λ,μ)\n\n**Find minimum over x:**\n∇_x L = Qx + c - Aᵀλ - μ = 0\n→ Qx = Aᵀλ + μ - c\n\nIf Q ≻ 0 (positive definite):\nx*(λ,μ) = Q⁻¹(Aᵀλ + μ - c)\n\n**Substitute back:**\ng(λ,μ) = (1/2)(Aᵀλ+μ-c)ᵀQ⁻¹(Aᵀλ+μ-c) + cᵀQ⁻¹(Aᵀλ+μ-c)\n         - λᵀ(AQ⁻¹(Aᵀλ+μ-c) - b) - μᵀQ⁻¹(Aᵀλ+μ-c)\n\n**Simplify:** (algebra omitted)\ng(λ,μ) = -(1/2)(Aᵀλ+μ-c)ᵀQ⁻¹(Aᵀλ+μ-c) + λᵀb\n\n**Dual Problem:**\nmax -(1/2)(Aᵀλ+μ-c)ᵀQ⁻¹(Aᵀλ+μ-c) + λᵀb\ns.t. λ, μ ≥ 0\n\n**For QP with only equality constraints (Ax = b):**\nSimpler form:\nmax -(1/2)λᵀAQ⁻¹Aᵀλ + (b + AQ⁻¹c)ᵀλ\n\n**Example:**\nmin x₁² + x₂² - 2x₁ - 4x₂, s.t. x₁ + x₂ ≤ 3, x ≥ 0\n\nQ = [[2,0],[0,2]], c = [-2,-4], A = [-1,-1], b = -3\n\nDual becomes simpler to solve than primal in some cases!"
  },
  {
    "id": "math404-t3-ex12",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Bidual Problem",
    "description": "Formulate the bidual (dual of the Lagrangian dual) and relate it to the primal.",
    "difficulty": 4,
    "hints": [
      "Start with Lagrangian dual",
      "Take dual of the dual problem",
      "For convex problems, bidual = primal"
    ],
    "solution": "**Primal:**\nmin f(x)\ns.t. gᵢ(x) ≤ 0, i=1,...,m\n     hⱼ(x) = 0, j=1,...,p\n\n**Lagrangian Dual:**\nmax g(λ,ν) = inf_x L(x,λ,ν)\ns.t. λ ≥ 0\n\nwhere L(x,λ,ν) = f(x) + Σλᵢgᵢ(x) + Σνⱼhⱼ(x)\n\n**For convex problem:** Bidual = Primal (strong duality)\n\n**Example: QP**\nP: min (1/2)xᵀQx + cᵀx, s.t. Ax = b\n\n**Lagrangian:**\nL(x,ν) = (1/2)xᵀQx + cᵀx + νᵀ(Ax - b)\n\n**Dual function:**\ng(ν) = inf_x L = -(1/2)(Aᵀν+c)ᵀQ⁻¹(Aᵀν+c) + cᵀQ⁻¹(Aᵀν+c) - νᵀb\n\n**Dual:**\nD: max g(ν)\n\n**Bidual:**\ninf_x sup_ν L(x,ν)\n\n**Von Neumann Minimax Theorem:**\nFor convex-concave L:\ninf_x sup_ν L(x,ν) = sup_ν inf_x L(x,ν)\n\nLeft side = Primal\nRight side = Dual\n\n**Strong Duality ⟺ Minimax Equality**\n\n**Slater's Condition:**\nIf ∃x̃: gᵢ(x̃) < 0 for all i (strictly feasible), then strong duality holds.\n\n**Summary:**\nBidual recovers primal for convex problems with constraint qualification.\nThis is fundamental result in convex analysis!"
  },
  {
    "id": "math404-t3-ex13",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Sensitivity from Dual Solution",
    "description": "Use the optimal dual solution to perform sensitivity analysis on constraint RHS.",
    "difficulty": 3,
    "hints": [
      "Dual optimal gives shadow prices",
      "Valid in neighborhood of optimum",
      "Δz ≈ Σyᵢ*Δbᵢ for small changes"
    ],
    "solution": "**Problem:**\nmax 5x₁ + 4x₂ + 6x₃\ns.t. x₁ + x₂ + x₃ ≤ 20   (resource 1)\n     2x₁ + x₂ + 3x₃ ≤ 30  (resource 2)\n     x ≥ 0\n\n**Optimal Solutions:**\nPrimal: x* = (0, 15, 5), z* = 90\nDual: y* = (0, 2), z*_D = 60\n\nWait, that doesn't match. Let me recalculate.\n\nActually solving:\nOptimal: x* = (10, 0, 10/3), z* = 50 + 20 = 70\nDual: y* = (1, 2), verify: y₁ + 2y₂ = 5 ✓, y₁ + y₂ = 3 ✗\n\nLet me use correct values:\nPrimal optimal: x* = (15, 0, 5), z* = 75 + 30 = 105\nCheck: 15 + 5 = 20 ✓, 30 + 15 = 45 > 30 ✗\n\n**Correct Example:**\nmax 3x₁ + 2x₂\ns.t. x₁ + x₂ ≤ 4    (b₁ = 4)\n     2x₁ + x₂ ≤ 6   (b₂ = 6)\n     x ≥ 0\n\nOptimal: x* = (2, 2), z* = 10\nDual: y* = (1, 1)\n\n**Sensitivity Analysis:**\n\n**Question 1:** Increase b₁ from 4 to 5?\nΔz ≈ y₁*Δb₁ = 1·1 = 1\nNew objective ≈ 10 + 1 = 11\n\n**Verify:** Resolving with b₁ = 5:\nNew optimal: x = (2.5, 2.5) (if both stay active)\nWait: x₁ + x₂ = 5, 2x₁ + x₂ = 6 → x₁ = 1, x₂ = 4\nCheck: 1 + 4 = 5 ✓, 2 + 4 = 6 ✓\nz = 3·1 + 2·4 = 11 ✓ Matches!\n\n**Question 2:** Increase b₂ from 6 to 7?\nΔz ≈ y₂*Δb₂ = 1·1 = 1\nNew z ≈ 11\n\n**Verify:** x₁ + x₂ = 4, 2x₁ + x₂ = 7\n→ x₁ = 3, x₂ = 1\nz = 3·3 + 2·1 = 11 ✓\n\n**Multiple changes:**\nΔb₁ = +1, Δb₂ = -0.5\nΔz ≈ 1·1 + 1·(-0.5) = 0.5\nNew z ≈ 10.5\n\n**Valid range:** Shadow prices valid while basis unchanged."
  },
  {
    "id": "math404-t3-ex14",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Reduced Cost Interpretation",
    "description": "Interpret reduced costs in terms of the dual problem and optimality.",
    "difficulty": 3,
    "hints": [
      "Reduced cost c̄ⱼ = cⱼ - yᵀAⱼ",
      "c̄ⱼ = rate of objective change if xⱼ increases from 0",
      "c̄ⱼ = 0 for basic variables, c̄ⱼ ≥ 0 for optimality"
    ],
    "solution": "**Optimal Tableau:**\n| BV | x₁ | x₂ | x₃ | s₁ | s₂ | RHS | c̄ⱼ |\n|----|----|----|----|----|----|-----|-----|\n| x₁ | 1  | 0  | 2  | 1  | 0  | 3   | 0   |\n| x₂ | 0  | 1  | -1 | 0  | 1  | 2   | 0   |\n| z  | 0  | 0  | 3  | 1  | 2  | 13  |     |\n\nOriginal: max 3x₁ + 2x₂ + 4x₃\n\n**Reduced Costs:**\n- c̄₁ = 0 (basic)\n- c̄₂ = 0 (basic)\n- c̄₃ = 3 (from z-row)\n- c̄_s₁ = 1\n- c̄_s₂ = 2\n\n**Interpretation:**\n\n**1. For nonbasic variable x₃ (c̄₃ = 3):**\n- Currently x₃ = 0\n- If we force x₃ to increase by 1:\n  * Must maintain feasibility: adjust basic variables\n  * From tableau: x₁ decreases by 2, x₂ increases by 1\n  * Objective change: -3·2 + 2·1 + 4·1 = -2\n\nWait, that's negative. Let me recalculate.\nActually c̄₃ = 3 > 0 means current solution is NOT optimal!\nShould bring x₃ into basis.\n\nLet me assume we're at optimum with c̄₃ = -3 (for min):\n\n**For minimization:**\nc̄₃ = -3 < 0 → can improve by increasing x₃\nc̄₃ = 0 → indifferent\nc̄₃ > 0 → increasing x₃ worsens objective\n\n**Connection to Dual:**\nReduced cost = primal objective coef - dual constraint value\nc̄ⱼ = cⱼ - yᵀAⱼ\n\nwhere y = dual variables = shadow prices\n\n**Example:**\nIf c̄₃ = 2 in max problem:\n- Increasing x₃ by 1 improves objective by 2 (in isolation)\n- But maintaining feasibility requires changes\n- Net effect: would decrease objective by 2 (that's why it's nonbasic)\n\n**Economic interpretation:**\nc̄ⱼ = opportunity cost of bringing nonbasic variable into solution.\nIf c̄ⱼ > 0: cost exceeds benefit → stay at zero\nIf c̄ⱼ < 0: benefit exceeds cost → should increase (not optimal)\nIf c̄ⱼ = 0: alternative optimal solution"
  },
  {
    "id": "math404-t3-ex15",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Duality in Network Flow",
    "description": "Formulate the dual of a minimum cost flow problem and interpret the dual variables.",
    "difficulty": 4,
    "hints": [
      "Primal variables: flow on each arc",
      "Dual variables: potential at each node",
      "Complementary slackness: flow only on shortest paths"
    ],
    "solution": "**Minimum Cost Flow Primal:**\nmin Σ_{(i,j)∈A} cᵢⱼxᵢⱼ  (cost)\ns.t. Σⱼ xᵢⱼ - Σⱼ xⱼᵢ = bᵢ  for all nodes i  (flow conservation)\n     0 ≤ xᵢⱼ ≤ uᵢⱼ  (capacity)\n\nwhere bᵢ > 0 (supply), bᵢ < 0 (demand), bᵢ = 0 (transship)\n\n**Dual:**\nmax Σᵢ bᵢπᵢ - Σ_{(i,j)} uᵢⱼyᵢⱼ\ns.t. πᵢ - πⱼ - yᵢⱼ ≤ cᵢⱼ  for all arcs (i,j)\n     yᵢⱼ ≥ 0\n\nwhere πᵢ = node potential (price/height)\n\n**Reduced Cost Interpretation:**\nc̄ᵢⱼ = cᵢⱼ - (πᵢ - πⱼ)\nThis is the reduced cost of arc (i,j)\n\n**Complementary Slackness:**\n1. If 0 < xᵢⱼ < uᵢⱼ: c̄ᵢⱼ = 0 → πᵢ - πⱼ = cᵢⱼ\n2. If xᵢⱼ = 0: c̄ᵢⱼ ≥ 0 → πᵢ - πⱼ ≤ cᵢⱼ\n3. If xᵢⱼ = uᵢⱼ: c̄ᵢⱼ ≤ 0 → πᵢ - πⱼ ≥ cᵢⱼ\n\n**Interpretation:**\n- πᵢ = \"price\" at node i\n- Flow goes from high price to low price\n- c̄ᵢⱼ = actual cost - price differential\n- Flow only uses arcs with c̄ᵢⱼ = 0 (zero reduced cost)\n\n**Example: Shortest Path**\nSingle source s, single sink t, unit supply/demand\nDual potentials are shortest path distances!\n\n**Network Simplex:**\nMaintains spanning tree basis\nDual variables = node potentials\nOptimality: all nonbasic arcs have c̄ᵢⱼ ≥ 0"
  },
  {
    "id": "math404-t3-ex16",
    "subjectId": "math404",
    "topicId": "topic-3",
    "type": "written",
    "title": "Dual Degeneracy and Uniqueness",
    "description": "Analyze the relationship between primal degeneracy, dual degeneracy, and uniqueness of optimal solutions.",
    "difficulty": 4,
    "hints": [
      "Primal degeneracy ↔ multiple dual optima",
      "Dual degeneracy ↔ multiple primal optima",
      "Strict complementarity ↔ unique solutions"
    ],
    "solution": "**Definitions:**\n\n**Primal Degeneracy:** Basic variable = 0\n**Dual Degeneracy:** Nonbasic variable has c̄ⱼ = 0\n\n**Theorems:**\n\n1. **Primal degenerate ↔ Dual has multiple optima**\n   - If basic xᵢ* = 0, corresponding dual constraint can be slack\n   - Multiple dual solutions satisfy optimality\n\n2. **Dual degenerate ↔ Primal has multiple optima**\n   - If c̄ⱼ = 0 for nonbasic xⱼ, can bring xⱼ into basis\n   - Objective unchanged → alternative optimal solution\n\n**Example 1: Primal Degeneracy**\nmax 3x₁ + 2x₂\ns.t. x₁ + x₂ ≤ 4\n     x₁ ≤ 2\n     x₂ ≤ 2\n     x ≥ 0\n\nOptimal: x* = (2, 2), slack s₃ = 0 (degenerate basis)\n\nDual:\nmin 4y₁ + 2y₂ + 2y₃\ns.t. y₁ + y₂ ≥ 3\n     y₁ + y₃ ≥ 2\n     y ≥ 0\n\nMultiple dual optima:\ny = (2, 1, 0): z = 8 + 2 = 10\ny = (3, 0, 0): z = 12 ≠ 10 ✗\n\nActually y* = (1, 2, 0) gives 4 + 4 = 8\nCheck: 1 + 2 = 3 ≥ 3 ✓, 1 + 0 = 1 < 2 ✗\n\nLet me recalculate. With x* = (2,2), z* = 10\nActive constraints: x₁ + x₂ = 4, x₁ = 2, x₂ = 2\n\nDue to redundancy, multiple dual solutions possible.\n\n**Example 2: Dual Degeneracy**\nmax x₁ + x₂\ns.t. x₁ + x₂ ≤ 2\n     x ≥ 0\n\n**Optimal:** Any point on line x₁ + x₂ = 2 is optimal\nThis is dual degeneracy → multiple primal optima\n\n**Strict Complementarity:**\nDefinition: For every constraint i:\nEither sᵢ > 0 OR λᵢ > 0 (not both = 0)\n\n**If strict complementarity holds:**\n→ Unique primal solution\n→ Unique dual solution\n→ No degeneracy\n\n**Summary Table:**\n| Primal | Dual   | Implications          |\n|--------|--------|-----------------------|\n| Unique | Unique | Strict complementarity|\n| Unique | Mult.  | Primal degeneracy     |\n| Mult.  | Unique | Dual degeneracy       |\n| Mult.  | Mult.  | Both degenerate       |"
  }
]
