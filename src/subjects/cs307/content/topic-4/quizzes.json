[
  {
    "id": "cs307-quiz-4-1",
    "subjectId": "cs307",
    "topicId": "cs307-topic-4",
    "title": "Vulnerabilities - OWASP Top 10 Fundamentals",
    "questions": [
      {
        "id": "cs307-q46",
        "type": "multiple_choice",
        "prompt": "Which OWASP Top 10 vulnerability occurs when an application includes untrusted data in SQL queries?",
        "options": [
          "Injection",
          "Security Misconfiguration",
          "Broken Authentication",
          "Cross-Site Scripting (XSS)"
        ],
        "correctAnswer": 0,
        "explanation": "SQL injection is a type of injection vulnerability where attackers insert malicious SQL code into queries. This can lead to unauthorized data access, modification, or deletion. Parameterized queries and prepared statements prevent SQL injection."
      },
      {
        "id": "cs307-q47",
        "type": "true_false",
        "prompt": "Cross-Site Scripting (XSS) attacks allow attackers to execute malicious scripts in victims' browsers.",
        "correctAnswer": true,
        "explanation": "XSS vulnerabilities allow attackers to inject malicious JavaScript into web pages viewed by other users. This can steal cookies, session tokens, or sensitive data, perform actions on behalf of users, or redirect to malicious sites."
      },
      {
        "id": "cs307-q48",
        "type": "multiple_choice",
        "prompt": "What is the primary defense against Cross-Site Request Forgery (CSRF) attacks?",
        "options": [
          "Using strong passwords",
          "Encrypting all form data",
          "Using HTTPS for all connections",
          "Implementing CSRF tokens that are validated on state-changing requests"
        ],
        "correctAnswer": 3,
        "explanation": "CSRF tokens are unpredictable values tied to user sessions that must be included in state-changing requests. Attackers cannot guess these tokens, preventing them from forging requests. SameSite cookies also provide CSRF protection."
      },
      {
        "id": "cs307-q49",
        "type": "multiple_choice",
        "prompt": "What type of vulnerability occurs when applications expose references to internal objects like database keys?",
        "options": [
          "XSS",
          "Buffer Overflow",
          "SQL Injection",
          "Insecure Direct Object Reference (IDOR)"
        ],
        "correctAnswer": 3,
        "explanation": "IDOR vulnerabilities occur when applications expose direct references to internal objects (like /user/1234) without proper authorization checks. Attackers can manipulate these references to access unauthorized data by changing IDs in URLs or parameters."
      },
      {
        "id": "cs307-q50",
        "type": "true_false",
        "prompt": "Buffer overflow vulnerabilities only affect interpreted languages like Python and JavaScript.",
        "correctAnswer": false,
        "explanation": "Buffer overflow vulnerabilities primarily affect compiled languages like C and C++ that don't perform automatic bounds checking. When programs write more data to a buffer than it can hold, they can overwrite adjacent memory, potentially allowing code execution. Modern languages like Python and Java are not susceptible to traditional buffer overflows."
      }
    ]
  },
  {
    "id": "cs307-quiz-4-2",
    "subjectId": "cs307",
    "topicId": "cs307-topic-4",
    "title": "Vulnerabilities - XSS, IDOR, and Security Misconfiguration",
    "questions": [
      {
        "id": "cs307-q51",
        "type": "multiple_choice",
        "prompt": "Which type of XSS occurs when malicious scripts are permanently stored on target servers (like in a database)?",
        "options": [
          "Stored XSS (Persistent XSS)",
          "Universal XSS",
          "Reflected XSS",
          "DOM-based XSS"
        ],
        "correctAnswer": 0,
        "explanation": "Stored XSS occurs when malicious input is saved to a database or file system and later displayed to users without proper sanitization. This is more dangerous than reflected XSS because it affects all users who view the compromised content, not just those who click a malicious link."
      },
      {
        "id": "cs307-q52",
        "type": "true_false",
        "prompt": "Security misconfiguration vulnerabilities can result from leaving default credentials, unnecessary features enabled, or verbose error messages.",
        "correctAnswer": true,
        "explanation": "Security misconfiguration is one of the most common vulnerabilities. It includes default passwords, unnecessary services, overly permissive file permissions, detailed error messages that leak information, and outdated software. Proper hardening and configuration management are essential."
      },
      {
        "id": "cs307-q53",
        "type": "multiple_choice",
        "prompt": "What is the primary risk of using components with known vulnerabilities?",
        "options": [
          "Increased application size",
          "Attackers can exploit publicly known weaknesses",
          "License compliance issues",
          "Slower performance"
        ],
        "correctAnswer": 1,
        "explanation": "When applications use libraries or frameworks with known vulnerabilities (disclosed in CVE databases), attackers can exploit these weaknesses. Keeping dependencies updated and monitoring vulnerability databases is crucial for maintaining security."
      },
      {
        "id": "cs307-q54",
        "type": "multiple_choice",
        "prompt": "Which vulnerability class involves manipulating file paths to access files outside intended directories?",
        "options": [
          "CSRF",
          "Privilege Escalation",
          "Path Traversal (Directory Traversal)",
          "SQL Injection"
        ],
        "correctAnswer": 2,
        "explanation": "Path traversal vulnerabilities allow attackers to access files outside the intended directory by manipulating file paths with sequences like \"../\". This can expose sensitive files like /etc/passwd or configuration files containing credentials. Input validation and sandboxing prevent this."
      },
      {
        "id": "cs307-q55",
        "type": "true_false",
        "prompt": "XML External Entity (XXE) attacks can allow attackers to read local files, perform SSRF attacks, or cause denial of service.",
        "correctAnswer": true,
        "explanation": "XXE vulnerabilities occur when XML parsers process external entity references. Attackers can use this to read local files, scan internal networks (SSRF), consume resources (DoS), or execute remote code. Disabling external entity processing in XML parsers prevents XXE attacks."
      }
    ]
  },
  {
    "id": "cs307-quiz-4-3",
    "subjectId": "cs307",
    "topicId": "cs307-topic-4",
    "title": "Vulnerabilities - SSRF, DoS, and Advanced Threats",
    "questions": [
      {
        "id": "cs307-q56",
        "type": "multiple_choice",
        "prompt": "What is a common consequence of insufficient logging and monitoring?",
        "options": [
          "Faster development cycles",
          "Improved application performance",
          "Delayed detection of security breaches and incidents",
          "Reduced storage requirements"
        ],
        "correctAnswer": 2,
        "explanation": "Without proper logging and monitoring, security incidents may go undetected for months. Effective logging helps detect attacks, investigate incidents, and meet compliance requirements. Logs should capture authentication events, access control failures, and input validation failures."
      },
      {
        "id": "cs307-q57",
        "type": "true_false",
        "prompt": "Server-Side Request Forgery (SSRF) allows attackers to make the server perform requests to arbitrary destinations, potentially accessing internal systems.",
        "correctAnswer": true,
        "explanation": "SSRF vulnerabilities occur when applications fetch remote resources based on user input without validation. Attackers can make servers access internal services, cloud metadata endpoints (like AWS metadata at 169.254.169.254), or perform port scanning. Whitelist validation and network segmentation mitigate SSRF."
      },
      {
        "id": "cs307-q58",
        "type": "multiple_choice",
        "prompt": "What is the main purpose of implementing Content Security Policy (CSP)?",
        "options": [
          "To prevent SQL injection",
          "To enforce password complexity",
          "To mitigate XSS attacks by controlling which resources can be loaded",
          "To encrypt all website content"
        ],
        "correctAnswer": 2,
        "explanation": "Content Security Policy is a browser security mechanism that restricts which resources (scripts, styles, images) can be loaded and from where. By disallowing inline scripts and restricting sources, CSP significantly reduces the impact of XSS attacks."
      },
      {
        "id": "cs307-q59",
        "type": "multiple_choice",
        "prompt": "Which attack technique involves flooding a system with requests to make it unavailable to legitimate users?",
        "options": [
          "Denial of Service (DoS)",
          "Man-in-the-Middle",
          "SQL Injection",
          "Phishing"
        ],
        "correctAnswer": 0,
        "explanation": "DoS attacks aim to exhaust system resources (bandwidth, CPU, memory, connections) making services unavailable. Distributed DoS (DDoS) uses multiple systems to amplify the attack. Mitigations include rate limiting, traffic filtering, CDNs, and auto-scaling."
      },
      {
        "id": "cs307-q60",
        "type": "true_false",
        "prompt": "Race condition vulnerabilities can occur when multiple processes access shared resources without proper synchronization.",
        "correctAnswer": true,
        "explanation": "Race conditions occur when the outcome depends on the sequence or timing of uncontrollable events. In security, this can lead to privilege escalation, authentication bypasses, or data corruption. Proper locking mechanisms, atomic operations, and secure design prevent race conditions."
      }
    ]
  }
]
